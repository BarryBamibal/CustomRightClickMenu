<dom-module id="error-reporting-tool">
	<template>
		<style>
			#errorToolContent {
				position:fixed;
				z-index: 99999999999999;
				width: 0;
				height: 0;
			}
	
			#iconContent {
				transform: translate(calc(100vw - 110px), calc(100vh - 100px));
			}
	
			#overlay {
				position: fixed;
				width:100vw;
				height:100vh;
				pointer-events: none;
				z-index:50;
				cursor: crosshair;
				opacity: 0;
				transition: opacity ease-in-out 0.3s;
			}
	
				#overlay.toggled {
					opacity: 1;
				}
	
			#reportBugButton, #reportBugButton iron-icon {
				width: 50px;
				height: 50px;
			}
	
			#reportingButtonElevation {
				border-radius: 50%;
				width:66px;
				height:66px;
				background-color: white;
				cursor:pointer;
			}
	
			#cropCanvas {
				display: none;
			}
	
			#errorReportingDialog, #onErrorDialog {
				width: 800px;
				position: static !important;
				top: inherit !important;
				max-height: none !important;
				z-index:2000;
			}
	
			.bugReportInfo {
				font-weight: bold;
			}
	
			.canvasCont, .addImg {
				width: 148.4px;
				padding: 0 1px;
				cursor: pointer;
			}
	
			.imagesTitle {
				font-weight: 400;
				font-size: 120%;
			}
	
			#highlightingCont {
				width: 100vw;
				height: 100vh;
				-webkit-user-drag: none;
			}
	
				#highlightingCont div {
					background-color: rgba(0,0,0,0.35);
					-webkit-user-drag: none;
					position: absolute;
					pointer-events: none;
					will-change: transform;
					will-change: width;
					will-change: height;
				}
	
			#highlightingTopSquare, #highlightingBotSquare {
				width: 100vw;
			}
	
			#highlightingTopSquare {
				height: 100vh;
			}
	
			#highlightButtons {
				position: absolute;
				font-size: 180%;
				transform: translate(calc((100vw - 250px) / 2), 85vh);
				z-index:100;
				opacity: 1;
				transition: opacity ease-in-out 0.3s;
			}
	
				#highlightButtons.hidden {
					pointer-events:none;
					opacity: 0;
				}
	
			#submitHighlightButton, #cancelHighlightButton {
				background-color: white;
			}
	
			.capture {
				width: 750px;
				cursor:pointer;
			}
	
			.captureElevation {
				width: 750px;
			}
	
			.imgContainer {
				display: -webkit-flex;
				display: flex;
				flex-direction: row;
				justify-content: center;
			}
	
			#errorCont {
				color: #D50000;
				font-weight: bold;
				font-size: 120%;
			}
	
			#bugCheckmark {
				-webkit-transform: rotate(45deg);
				transform: rotate(45deg);
				position: absolute;
				top: 36px;
				left: 24px;
				width: 0;
				height: 0;
				border-style: solid;
				border-top: none;
				border-left: none;
				border-right-width: 0;
				border-bottom-width: 0;
				border-color: white;
				margin-top: 8px;
				margin-left: 4px;
			}
	
			#bugCheckmark.checked {
				animation: error-checkmark-expand 140ms ease-out forwards;
			}
	
	
			@keyframes error-checkmark-expand {
				0% {
					top: 36px;
					left: 24px;
					width: 0;
					height: 0;
					border-right-width: 6px;
					border-bottom-width: 6px;
				}
				100% {
					top: -4px;
					left: 16px;
					width: 20px;
					height: 40px;
					border-right-width: 6px;
					border-bottom-width: 6px;
				}
			}
	
			#bugCheckmarkCont {
				border-radius:50%;
				width:66px;
				height:66px;
				background-color:#4CAF50;
				opacity: 0;
				transition: opacity 350ms ease-in-out;
			}
	
				#bugCheckmarkCont.checkmark {
					opacity: 1;
				}
	
			#bugButton {
				opacity: 1;
				transition: opacity 350ms ease-in-out;
				border-radius:50%;
			}
	
			#bugButton.checkmark {
				opacity: 0;
			}
	
			#reportingButtonElevation.checkmark #bugButton {
				display: none;
			}
		</style>
		<div id="error-reporting-overlay" hidden$="{{hide}}">
			<div id="errorToolContent">
				<canvas id="cropCanvas"></canvas>
				<div id="iconContent">
					<paper-material elevation="5" id="reportingButtonElevation">
						<div id="bugButton">
							<paper-icon-button noink id="reportBugButton" icon="bug-report" on-tap="reportBug"></paper-icon-button>
							<paper-ripple></paper-ripple>
						</div>
						<div id="bugCheckmarkCont">
							<div id="bugCheckmark"></div>
						</div>
					</paper-material>
				</div>
			</div>
			<div id="overlay" on-track="handleSelection">
				<div id="highlightButtons">
					<paper-button id="submitHighlightButton" raised on-tap="finishScreencap">Finish</paper-button>
					<paper-button id="cancelHighlightButton" raised on-tap="cancelScreencap">Cancel</paper-button>
				</div>
				<div id="highlightingCont">
					<div data-element-type="ErrorReportingToolSquare" id="highlightingTopSquare"></div>
					<div data-element-type="ErrorReportingToolSquare" id="highlightingLeftSquare"></div>
					<div data-element-type="ErrorReportingToolSquare" id="highlightingRightSquare"></div>
					<div data-element-type="ErrorReportingToolSquare" id="highlightingBotSquare"></div>
				</div>
			</div>
		</div>
		<center-element fullscreenoverlay id="errorReportingCenterer">
			<paper-dialog with-backdrop id="errorReportingDialog" entry-animation="scale-up-animation" exit-animation="fade-out-animation">
				<br />
				<h2>Reporting a bug or suggesting a feature</h2>
				<div>
					<span>
						You can report a bug that happened or a feature you would like to see in this extension. If you want you can also highlight a section of the page and send it along.
						When clicking the submit buton you will be taken to the github website where you can file an issue. All nessecary files (the image<span hidden$="{{!isBugType(reportType)}}"> and your settings</span>) will be downloaded, after which you can drop them on the report issue page. For this to be possible you need to accept the downloads permission window that will pop up.
					</span>
					<span class="bugReportInfo" hidden$="{{!isBugType(reportType)}}">Your CRM and settings will be included in the report that will be publicly visible, if you do not wish this you can report a bug or suggest a feature by sending an email to <a target="_blank" href="mailto:awsdfgvhbjn@gmail.com">this address.</a></span>
				</div>
				<div class="imagesContainer">
					<div class="imagesTitle">Page Capture</div>
					<div class="imgContainer" hidden$="[[isEmptyImage(image)]]" on-tap="addCapture">
						<paper-material class="captureElevation captureCont" elevation="2">
							<img src="[[image]]" class="capture captureCont" alt="screencap">
						</paper-material>
					</div>
					<div class="addImg" hidden$="[[!isEmptyImage(image)]]">
						<paper-button on-tap="addCapture" raised>ADD</paper-button>
					</div>
				</div>
				<paper-radio-group selected="{{reportType}}">
					<paper-radio-button name="bug">Reporting a bug</paper-radio-button>
					<paper-radio-button name="feature">Suggesting a feature</paper-radio-button>
				</paper-radio-group>
				<div class="buttons">
					<paper-button on-tap="submitErrorReport">submit</paper-button>
					<paper-button dialog-dismiss>close</paper-button>
				</div>
			</paper-dialog>
		</center-element>
	</template>
</dom-module>
<script src="error-reporting-tool.js"></script>